import constants from "./constants.mjs"

const HEADER_INCLUDE = (type) => `
#define CANVAS_WIDTH ${constants.CANVAS_WIDTH}
#define CANVAS_HEIGHT ${constants.CANVAS_HEIGHT}
#define UNIVERSE_WIDTH ${constants.UNIVERSE_WIDTH}
#define UNIVERSE_HEIGHT ${constants.UNIVERSE_HEIGHT}

precision highp float;
precision highp int;

struct Cell {
	uint x;
};

layout(std430, binding = 0) coherent restrict ${type == "FRAGMENT" ? "readonly" : ""} buffer UniverseBufferData {
	Cell[UNIVERSE_WIDTH][UNIVERSE_HEIGHT] cells;
} universe[2];

layout(std430, binding = 2) restrict ${type == "FRAGMENT" ? "readonly" : "coherent"} buffer UniverseRenderData {
	uint colorMax;
};

`

const vertexShaderSource = `#version 310 es
	in vec2 position;
	
	void main(void) {
		gl_Position = vec4(position, 0.0, 1.0);
	}`

const fragmentShaderSource = `#version 310 es

	${HEADER_INCLUDE("FRAGMENT")}

	const vec3 gradient[] = vec3[](
		vec3(0,0,0),
		vec3(0.004436044,0.0002535,0.003784998),
		vec3(0.009037121,0.000440904,0.007745918),
		vec3(0.013424348,0.000705104,0.011583541),
		vec3(0.017975277,0.000903489,0.015598643),
		vec3(0.022500891,0.00110741,0.019641194),
		vec3(0.027001282,0.00131684,0.023711157),
		vec3(0.031476545,0.001531754,0.027808499),
		vec3(0.035926774,0.001752125,0.031933181),
		vec3(0.040352067,0.001977925,0.036085168),
		vec3(0.044725474,0.002139055,0.040420875),
		vec3(0.048661721,0.002375794,0.044440537),
		vec3(0.052529897,0.002548126,0.048407283),
		vec3(0.05619182,0.002726094,0.052195697),
		vec3(0.059672555,0.002909667,0.055828262),
		vec3(0.06312355,0.003029539,0.059445693),
		vec3(0.066294261,0.003224388,0.062813812),
		vec3(0.069456462,0.003355785,0.06618652),
		vec3(0.072492391,0.003492974,0.06945309),
		vec3(0.075413362,0.003635919,0.072623493),
		vec3(0.078229099,0.003784585,0.075706277),
		vec3(0.081052946,0.003870598,0.07881014),
		vec3(0.083679252,0.004030754,0.081736361),
		vec3(0.086321488,0.004128491,0.084690933),
		vec3(0.088785282,0.004299987,0.087484036),
		vec3(0.091270567,0.004409295,0.090310701),
		vec3(0.093683724,0.004524404,0.093078976),
		vec3(0.096117639,0.004577853,0.095880825),
		vec3(0.098397468,0.004704596,0.098541835),
		vec3(0.100614153,0.004837486,0.101164795),
		vec3(0.102752261,0.004979139,0.103805668),
		vec3(0.104812737,0.005129981,0.106472094),
		vec3(0.106874715,0.005223799,0.109251709),
		vec3(0.108786984,0.005393488,0.111969723),
		vec3(0.110701685,0.00550683,0.114802069),
		vec3(0.11254555,0.005630186,0.117661035),
		vec3(0.11432093,0.005763634,0.120546588),
		vec3(0.116029941,0.005907256,0.123458693),
		vec3(0.117674482,0.006061135,0.12639732),
		vec3(0.119256264,0.006225355,0.129362434),
		vec3(0.120835491,0.006335962,0.132446642),
		vec3(0.122351763,0.006457154,0.135558548),
		vec3(0.123791909,0.006621619,0.138605044),
		vec3(0.125231534,0.006752099,0.141679035),
		vec3(0.126614018,0.006915097,0.144685155),
		vec3(0.127995499,0.007045708,0.147717248),
		vec3(0.129320144,0.007212081,0.150678653),
		vec3(0.130643456,0.007347619,0.153664532),
		vec3(0.131910401,0.007522059,0.156576942),
		vec3(0.133175819,0.007667163,0.159512351),
		vec3(0.134439278,0.007782886,0.162470669),
		vec3(0.135646962,0.007941282,0.165352038),
		vec3(0.136852657,0.00807174,0.168254862),
		vec3(0.138055993,0.008174213,0.171179056),
		vec3(0.139204409,0.008322987,0.174022863),
		vec3(0.140350582,0.008445159,0.176886605),
		vec3(0.14144281,0.008616437,0.179667275),
		vec3(0.142533007,0.008762435,0.18246646),
		vec3(0.143620896,0.008883099,0.185284076),
		vec3(0.144706207,0.008978373,0.188120037),
		vec3(0.145738986,0.009126726,0.190868861),
		vec3(0.146769547,0.009250941,0.193634628),
		vec3(0.147748829,0.009430799,0.196310632),
		vec3(0.148774734,0.009507224,0.199109414),
		vec3(0.149749824,0.009640477,0.201817045),
		vec3(0.150722751,0.009750648,0.204540058),
		vec3(0.151646272,0.009920082,0.207169324),
		vec3(0.152568186,0.010067553,0.209812597),
		vec3(0.153488343,0.010192985,0.212469791),
		vec3(0.154406601,0.010296304,0.215140819),
		vec3(0.15532282,0.010377432,0.217825594),
		vec3(0.156192092,0.010521752,0.220412004),
		vec3(0.157060008,0.010644922,0.2230108),
		vec3(0.157926462,0.010746858,0.225621891),
		vec3(0.15874797,0.010914675,0.228131411),
		vec3(0.159568765,0.011062233,0.230651881),
		vec3(0.160388773,0.011189443,0.233183212),
		vec3(0.161207921,0.011296212,0.235725312),
		vec3(0.162026143,0.011382446,0.238278088),
		vec3(0.162802355,0.011538034,0.240724796),
		vec3(0.163578483,0.011673992,0.243180851),
		vec3(0.164354487,0.01179022,0.245646163),
		vec3(0.165130527,0.011885852,0.248120654),
		vec3(0.16590248,0.011976729,0.250603863),
		vec3(0.166668651,0.012069494,0.25309555),
		vec3(0.167390941,0.01225731,0.255475601),
		vec3(0.168146142,0.012354332,0.257983434),
		vec3(0.168895665,0.012453182,0.260499493),
		vec3(0.16963955,0.012553837,0.263023689),
		vec3(0.170377836,0.012656272,0.265555932),
		vec3(0.171074922,0.012856309,0.267973315),
		vec3(0.171802651,0.012962758,0.27052082),
		vec3(0.172524921,0.013070899,0.273076092),
		vec3(0.173241781,0.013180699,0.275639032),
		vec3(0.173953285,0.013292123,0.278209543),
		vec3(0.174659487,0.013405134,0.280787523),
		vec3(0.175360445,0.013519692,0.283372869),
		vec3(0.176056219,0.013635757,0.285965475),
		vec3(0.176746873,0.013753287,0.288565236),
		vec3(0.177432471,0.013872235,0.291172043),
		vec3(0.178113083,0.013992556,0.293785785),
		vec3(0.178758839,0.014216008,0.29627753),
		vec3(0.179430227,0.014339476,0.298904267),
		vec3(0.18009685,0.014464165,0.3015376),
		vec3(0.180758789,0.014590022,0.30417741),
		vec3(0.181416124,0.014716991,0.306823577),
		vec3(0.182068942,0.014845013,0.309475981),
		vec3(0.182717329,0.014974028,0.312134498),
		vec3(0.183387535,0.014998297,0.314931539),
		vec3(0.184026788,0.015128554,0.317602429),
		vec3(0.184661889,0.015259611,0.32027905),
		vec3(0.185292936,0.015391402,0.322961271),
		vec3(0.185920033,0.015523858,0.325648962),
		vec3(0.186543284,0.015656907,0.328341988),
		vec3(0.187162797,0.015790478,0.331040214),
		vec3(0.187778683,0.015924495,0.333743503),
		vec3(0.188391056,0.016058884,0.336451717),
		vec3(0.189000031,0.016193567,0.339164716),
		vec3(0.18960573,0.016328464,0.341882357),
		vec3(0.190208275,0.016463494,0.344604499),
		vec3(0.19080779,0.016598577,0.347330996),
		vec3(0.191404405,0.016733627,0.350061702),
		vec3(0.19199825,0.01686856,0.35279647),
		vec3(0.19258946,0.017003288,0.355535151),
		vec3(0.193178172,0.017137725,0.358277595),
		vec3(0.193764524,0.01727178,0.361023651),
		vec3(0.194348661,0.017405363,0.363773166),
		vec3(0.194930726,0.017538381,0.366525987),
		vec3(0.195510868,0.017670743,0.369281958),
		vec3(0.196089237,0.017802352,0.372040924),
		vec3(0.196665987,0.017933113,0.374802728),
		vec3(0.197241274,0.01806293,0.377567213),
		vec3(0.197815255,0.018191705,0.380334219),
		vec3(0.198388092,0.018319339,0.383103587),
		vec3(0.198959947,0.018445733,0.385875158),
		vec3(0.199530986,0.018570784,0.38864877),
		vec3(0.200101378,0.018694393,0.391424262),
		vec3(0.20067129,0.018816456,0.394201472),
		vec3(0.201240897,0.01893687,0.396980239),
		vec3(0.201810372,0.019055531,0.399760399),
		vec3(0.202379891,0.019172334,0.402541789),
		vec3(0.202941861,0.019412452,0.405175931),
		vec3(0.203512549,0.019525866,0.407958871),
		vec3(0.204083818,0.019637109,0.410742556),
		vec3(0.204655851,0.019746072,0.413526824),
		vec3(0.205228831,0.019852647,0.41631151),
		vec3(0.205797849,0.020085246,0.418946074),
		vec3(0.206373815,0.020187386,0.42173071),
		vec3(0.206951286,0.020286818,0.424515282),
		vec3(0.207530449,0.020383432,0.42729963),
		vec3(0.208108483,0.020608297,0.429931638),
		vec3(0.208692122,0.020699628,0.432714671),
		vec3(0.20927802,0.020787816,0.435497007),
		vec3(0.209866369,0.020872752,0.438278486),
		vec3(0.210456372,0.021088232,0.440905484),
		vec3(0.2110507,0.021167031,0.443684414),
		vec3(0.211648031,0.021377539,0.446307832),
		vec3(0.212249085,0.021449779,0.449083613),
		vec3(0.212853535,0.021518226,0.451857778),
		vec3(0.213462993,0.021720171,0.454474922),
		vec3(0.214075285,0.021781422,0.457245061),
		vec3(0.214693879,0.021977386,0.459857209),
		vec3(0.215314746,0.022031021,0.462622757),
		vec3(0.21594318,0.022220604,0.46522937),
		vec3(0.216577007,0.022407208,0.467832859),
		vec3(0.217212307,0.022449014,0.470590342),
		vec3(0.217856999,0.022628651,0.473187529),
		vec3(0.218507576,0.022805027,0.475781227),
		vec3(0.219158861,0.022834091,0.478529493),
		vec3(0.219821285,0.023002922,0.48111617),
		vec3(0.220490063,0.023168213,0.483699017),
		vec3(0.221158814,0.023183639,0.486436995),
		vec3(0.221840368,0.02334082,0.489012157),
		vec3(0.222528715,0.023494191,0.49158318),
		vec3(0.223223992,0.023643664,0.494149968),
		vec3(0.223926331,0.023789154,0.49671243),
		vec3(0.22463586,0.023930575,0.499270479),
		vec3(0.225344012,0.023916923,0.50198475),
		vec3(0.226067958,0.024049161,0.504533985),
		vec3(0.226799457,0.024177078,0.507078567),
		vec3(0.227538616,0.024300593,0.509618423),
		vec3(0.22828554,0.024419627,0.512153488),
		vec3(0.229040325,0.024534105,0.514683702),
		vec3(0.229803062,0.02464395,0.517209008),
		vec3(0.230573837,0.024749089,0.519729355),
		vec3(0.231363829,0.025006905,0.522082039),
		vec3(0.232151174,0.025103261,0.524592115),
		vec3(0.232946764,0.025194707,0.527097115),
		vec3(0.233750657,0.025281178,0.529597011),
		vec3(0.234562904,0.02536261,0.532091781),
		vec3(0.235395858,0.025600652,0.534417685),
		vec3(0.236225157,0.025672702,0.536901956),
		vec3(0.237062903,0.025739547,0.539381073),
		vec3(0.237922043,0.025965458,0.541690736),
		vec3(0.23877693,0.026022633,0.544159376),
		vec3(0.239640281,0.026074467,0.5466229),
		vec3(0.240525557,0.02628791,0.54891648),
		vec3(0.241405331,0.026330215,0.551370227),
		vec3(0.242299327,0.026540368,0.553660565),
		vec3(0.243178954,0.026582375,0.556118722),
		vec3(0.244057821,0.026624114,0.558579675),
		vec3(0.244950215,0.026837099,0.560877699),
		vec3(0.245827724,0.026879232,0.56334406),
		vec3(0.246719071,0.027094438,0.565647145),
		vec3(0.247595201,0.027136988,0.568118909),
		vec3(0.248306862,0.027277637,0.570729289),
		vec3(0.248752991,0.027398273,0.573710164),
		vec3(0.249192121,0.027529481,0.576690424),
		vec3(0.249624239,0.027671386,0.579670063),
		vec3(0.250049337,0.027824112,0.582649074),
		vec3(0.250467404,0.027987785,0.585627452),
		vec3(0.250878428,0.028162528,0.58860519),
		vec3(0.251282399,0.028348467,0.591582284),
		vec3(0.251658517,0.028371032,0.594723964),
		vec3(0.251997195,0.028481766,0.597841225),
		vec3(0.252291046,0.028701193,0.6009281),
		vec3(0.252517458,0.02885446,0.604149891),
		vec3(0.252673125,0.028945057,0.607505572),
		vec3(0.252777521,0.029156104,0.610827945),
		vec3(0.252805583,0.029312346,0.614282162),
		vec3(0.252778206,0.029597376,0.617701106),
		vec3(0.252642799,0.029656275,0.621415716),
		vec3(0.252445533,0.029852587,0.625092888),
		vec3(0.252157211,0.030011273,0.628897426),
		vec3(0.251773061,0.03013711,0.63282809),
		vec3(0.251318193,0.030414232,0.636718068),
		vec3(0.250759571,0.030668259,0.640731815),
		vec3(0.250058771,0.030725983,0.645033271),
		vec3(0.249274096,0.030950414,0.649290369),
		vec3(0.248367671,0.031168502,0.653667099),
		vec3(0.24733265,0.031386289,0.658162003),
		vec3(0.246161677,0.031610055,0.662773583),
		vec3(0.244846841,0.031846318,0.667500298),
		vec3(0.243379612,0.032101835,0.672340568),
		vec3(0.241750773,0.032383594,0.677292769),
		vec3(0.239902746,0.03252495,0.68251914),
		vec3(0.237917453,0.03288196,0.687689964),
		vec3(0.235685079,0.033115552,0.69313107),
		vec3(0.233239718,0.033407698,0.698676745),
		vec3(0.230507979,0.033596678,0.704488153),
		vec3(0.227525404,0.033863322,0.7103999),
		vec3(0.224272949,0.034216589,0.716410026),
		vec3(0.220659909,0.034499158,0.722678804),
		vec3(0.216649351,0.034724364,0.729203405),
		vec3(0.21227697,0.035069944,0.735819166),
		vec3(0.207424702,0.035383749,0.742685388),
		vec3(0.202124718,0.035841539,0.749637813),
		vec3(0.196135087,0.03613567,0.756995979),
		vec3(0.18945533,0.036444634,0.764595187),
		vec3(0.181980555,0.036785192,0.772432131),
		vec3(0.17357707,0.037174708,0.780503421),
		vec3(0.164069432,0.037631132,0.788805584),
		vec3(0.153065769,0.038022889,0.797494493),
		vec3(0.14033683,0.038523307,0.806406452),
		vec3(0.124936186,0.038860436,0.815855342),
		vec3(0.106189145,0.039355482,0.825518442),
		vec3(0.081814649,0.039888551,0.835549984),
		vec3(0.073413314,0.048846064,0.835693875),
		vec3(0.068304514,0.058139395,0.83406222),
		vec3(0.062807205,0.066553,0.832396154),
		vec3(0.056851642,0.074294128,0.830696417),
		vec3(0.050341566,0.081500389,0.828963747),
		vec3(0.043138117,0.088268428,0.82719888),
		vec3(0.039591621,0.09518325,0.824177478),
		vec3(0.03919385,0.102059502,0.820224013),
		vec3(0.03926725,0.108600988,0.816111589),
		vec3(0.038717691,0.114748848,0.812144959),
		vec3(0.038645421,0.120651307,0.808023072),
		vec3(0.038507037,0.126289145,0.803898373),
		vec3(0.038307622,0.131691081,0.799771835),
		vec3(0.038052046,0.136880903,0.795644414),
		vec3(0.037744967,0.141878578,0.791517044),
		vec3(0.037921263,0.146735238,0.787245223),
		vec3(0.037521787,0.151395108,0.783121563),
		vec3(0.037608705,0.155937468,0.778857002),
		vec3(0.037133107,0.160310747,0.774740567),
		vec3(0.037146233,0.164583974,0.770486716),
		vec3(0.03660926,0.168709824,0.76638086),
		vec3(0.036562698,0.172748957,0.762141005),
		vec3(0.036489825,0.17668121,0.757909785),
		vec3(0.036393681,0.180512893,0.753687963),
		vec3(0.035770173,0.184229018,0.749613576),
		vec3(0.035638532,0.187877221,0.745411835),
		vec3(0.035491787,0.191440374,0.741221654),
		vec3(0.035332384,0.194922787,0.737043716),
		vec3(0.035162637,0.198328411,0.732878683),
		vec3(0.034984734,0.201660885,0.728727197),
		vec3(0.034800744,0.204923568,0.724589881),
		vec3(0.034612623,0.20811957,0.72046734),
		vec3(0.034422217,0.211251778,0.71636016),
		vec3(0.034231276,0.21432288,0.712268906),
		vec3(0.03404145,0.217335385,0.708194129),
		vec3(0.0338543,0.220291637,0.70413636),
		vec3(0.033671306,0.223193834,0.700096111),
		vec3(0.033493866,0.22604404,0.696073881),
		vec3(0.033323305,0.228844195,0.692070149),
		vec3(0.033160882,0.231596128,0.688085379),
		vec3(0.033007789,0.234301566,0.684120017),
		vec3(0.032397166,0.236954598,0.680295849),
		vec3(0.032268067,0.239572385,0.676369635),
		vec3(0.032151507,0.242148301,0.672464079),
		vec3(0.03204847,0.244683736,0.668579568),
		vec3(0.031959902,0.247180013,0.664716474),
		vec3(0.03188671,0.249638389,0.660875156),
		vec3(0.031372843,0.252055468,0.657171607),
		vec3(0.031334713,0.254442021,0.653373909),
		vec3(0.031314446,0.256794093,0.649598982),
		vec3(0.030860779,0.259109411,0.645959927),
		vec3(0.030880176,0.261396003,0.642230495),
		vec3(0.030470618,0.263648575,0.638635612),
		vec3(0.030532509,0.26587346,0.634952805),
		vec3(0.030169637,0.268066859,0.631403176),
		vec3(0.030276732,0.270233502,0.627768032),
		vec3(0.029963025,0.272371011,0.624264655),
		vec3(0.029675382,0.274481899,0.620784278),
		vec3(0.029414353,0.276566884,0.61732712),
		vec3(0.029620904,0.278626696,0.61378913),
		vec3(0.029413732,0.280661602,0.610379974),
		vec3(0.029234855,0.282672611,0.606994638),
		vec3(0.029084819,0.28466034,0.603633304),
		vec3(0.02896417,0.286625382,0.600296146),
		vec3(0.028437557,0.288569807,0.597082873),
		vec3(0.028378095,0.290491463,0.593793618),
		vec3(0.028349642,0.292392086,0.590529014),
		vec3(0.028352769,0.294272193,0.587289207),
		vec3(0.027954722,0.29613489,0.584170118),
		vec3(0.028023299,0.297975702,0.580979367),
		vec3(0.027692753,0.29980057,0.577907717),
		vec3(0.027396873,0.301607318,0.5748595),
		vec3(0.027567942,0.303392718,0.571742778),
		vec3(0.027342573,0.305164222,0.568742693),
		vec3(0.027153348,0.306918829,0.565766363),
		vec3(0.027000766,0.308656918,0.562813883),
		vec3(0.02688534,0.310378857,0.559885347),
		vec3(0.026807595,0.312085004,0.556980838),
		vec3(0.026768071,0.313775702,0.554100438),
		vec3(0.026335962,0.31545658,0.551329784),
		vec3(0.026374406,0.317117596,0.548496903),
		vec3(0.026020925,0.318769865,0.545772067),
		vec3(0.02613945,0.320402441,0.542986981),
		vec3(0.025866559,0.322027294,0.540308224),
		vec3(0.025634514,0.323638968,0.537652139),
		vec3(0.025877169,0.325231156,0.534938728),
		vec3(0.025728819,0.326817067,0.532329059),
		vec3(0.025622855,0.328390584,0.529742214),
		vec3(0.025124639,0.329959134,0.527255551),
		vec3(0.025104334,0.331508792,0.524713576),
		vec3(0.025127982,0.333046771,0.522194551),
		vec3(0.024758663,0.334581057,0.519773101),
		vec3(0.024871079,0.336096534,0.517299177),
		vec3(0.024589826,0.337609126,0.514921081),
		vec3(0.02479319,0.339102942,0.512492383),
		vec3(0.024602034,0.340594646,0.510157764),
		vec3(0.024456162,0.342076288,0.507844471),
		vec3(0.024356073,0.343548049,0.505552531),
		vec3(0.02430228,0.345010108,0.503281964),
		vec3(0.024295308,0.34646264,0.501032792),
		vec3(0.023888172,0.347915219,0.498871516),
		vec3(0.0239751,0.349349369,0.496664292),
		vec3(0.023660088,0.350784235,0.494543208),
		vec3(0.023842975,0.352200635,0.492377996),
		vec3(0.023622,0.353618398,0.490297168),
		vec3(0.023447987,0.355027912,0.488236041),
		vec3(0.023321402,0.356429314,0.486194628),
		vec3(0.023242725,0.357822741,0.484172939),
		vec3(0.023212447,0.359208323,0.482170983),
		vec3(0.023231071,0.360586189,0.480188769),
		vec3(0.02283527,0.361967555,0.478283894),
		vec3(0.02295135,0.36333052,0.476340297),
		vec3(0.022650144,0.364697546,0.474472286),
		vec3(0.022865637,0.366046078,0.47256733),
		vec3(0.022660836,0.367399216,0.470736204),
		vec3(0.022503888,0.36874565,0.468923088),
		vec3(0.022395231,0.370085484,0.467127984),
		vec3(0.022335314,0.371418819,0.465350895),
		vec3(0.022324596,0.372745752,0.463591824),
		vec3(0.022363545,0.374066381,0.461850771),
		vec3(0.021967484,0.375393463,0.460176541),
		vec3(0.022104825,0.376701911,0.458470652),
		vec3(0.021803271,0.378017296,0.456829839),
		vec3(0.022040812,0.379313914,0.455159114),
		vec3(0.02183543,0.380617941,0.453551718),
		vec3(0.021677497,0.381916485,0.451960596),
		vec3(0.021567411,0.383209625,0.450385745),
		vec3(0.021505581,0.384497437,0.448827165),
		vec3(0.021492423,0.385779995,0.447284855),
		vec3(0.021528362,0.387057372,0.445758812),
		vec3(0.021613829,0.388329637,0.444249034),
		vec3(0.021235396,0.389611166,0.442794751),
		vec3(0.021418379,0.390873561,0.44131663),
		vec3(0.021132549,0.39214564,0.439892266),
		vec3(0.020892114,0.393413162,0.438482427),
		vec3(0.021222984,0.394661306,0.437051337),
		vec3(0.021077401,0.395919752,0.435671402),
		vec3(0.020978308,0.397173819,0.434305983),
		vec3(0.020926071,0.398423565,0.432955078),
		vec3(0.020921063,0.399669044,0.431618683),
		vec3(0.020963661,0.400910312,0.430296795),
		vec3(0.020509934,0.402163151,0.429020009),
		vec3(0.020645643,0.403396293,0.427726264),
		vec3(0.020830095,0.404625377,0.426447017),
		vec3(0.020509478,0.405866601,0.42521028),
		vec3(0.020231675,0.407104143,0.423986312),
		vec3(0.020557948,0.408321624,0.422748815),
		vec3(0.020370101,0.409551799,0.421551239),
		vec3(0.020226016,0.410778427,0.420366424),
		vec3(0.020126009,0.41200155,0.419194367),
		vec3(0.0200704,0.41322121,0.418035065),
		vec3(0.020059516,0.414437449,0.416888515),
		vec3(0.020093687,0.415650306,0.415754714),
		vec3(0.019935307,0.416867414,0.414635536),
		vec3(0.020156645,0.418072924,0.413497937),
		vec3(0.020375404,0.419278195,0.41235541),
		vec3(0.020591805,0.420483219,0.41120795),
		vec3(0.020215766,0.421705602,0.410072022),
		vec3(0.020426507,0.422910189,0.408913737),
		vec3(0.020635547,0.424114512,0.407750502),
		vec3(0.020843117,0.425318567,0.406582314),
		vec3(0.020452602,0.426540236,0.405421857),
		vec3(0.020656229,0.427743806,0.404242799),
		vec3(0.02085907,0.428947089,0.403058774),
		vec3(0.021061365,0.430150081,0.401869778),
		vec3(0.020659633,0.431370938,0.400684687),
		vec3(0.020859776,0.432573397,0.399484782),
		vec3(0.021060085,0.433775546,0.398279895),
		vec3(0.021260808,0.434977381,0.397070022),
		vec3(0.020851261,0.436197328,0.395860203),
		vec3(0.021051694,0.437398582,0.394639387),
		vec3(0.021253279,0.438599503,0.393413576),
		vec3(0.021456273,0.439800086,0.392182769),
		vec3(0.021042449,0.441019025,0.390948141),
		vec3(0.021247084,0.44221898,0.389706364),
		vec3(0.02145389,0.443418578,0.388459585),
		vec3(0.021663136,0.444617815,0.387207802),
		vec3(0.021248708,0.445835646,0.385948295),
		vec3(0.021461589,0.447034207,0.384685525),
		vec3(0.021677695,0.448232389,0.383417748),
		vec3(0.0218973,0.449430185,0.382144965),
		vec3(0.021486068,0.450646811,0.380860528),
		vec3(0.021711367,0.451843883,0.379576748),
		vec3(0.021940974,0.453040553,0.378287963),
		vec3(0.022175171,0.454236814,0.376994176),
		vec3(0.021771055,0.455452135,0.375684775),
		vec3(0.022013062,0.456647625,0.374379992),
		vec3(0.02226049,0.457842689,0.373070213),
		vec3(0.021863808,0.459056983,0.37174183),
		vec3(0.022120658,0.46025124,0.370421064),
		vec3(0.022383775,0.461445053,0.369095311),
		vec3(0.02265345,0.462638417,0.367764575),
		vec3(0.022270989,0.463851235,0.366411223),
		vec3(0.022552295,0.465043746,0.365069526),
		vec3(0.022841024,0.466235789,0.363722863),
		vec3(0.022471404,0.467447451,0.362350551),
		vec3(0.022773439,0.468638605,0.360992955),
		vec3(0.022412908,0.469849485,0.359607677),
		vec3(0.022729365,0.471039727,0.358239171),
		vec3(0.023054704,0.472229474,0.356865736),
		vec3(0.022710964,0.473439107,0.355461555),
		vec3(0.023052438,0.474627906,0.354077256),
		vec3(0.022720417,0.475836696,0.352660155),
		vec3(0.023079163,0.477024525,0.351265029),
		vec3(0.023448276,0.47821183,0.349865026),
		vec3(0.023137082,0.479419284,0.348429123),
		vec3(0.02352521,0.480605585,0.34701836),
		vec3(0.023228413,0.481812137,0.345569618),
		vec3(0.02363671,0.48299741,0.344148147),
		vec3(0.023355384,0.484203036,0.342686607),
		vec3(0.02378501,0.48538726,0.341254485),
		vec3(0.023520233,0.486591937,0.339780196),
		vec3(0.023262802,0.487796158,0.338299015),
		vec3(0.023725209,0.488978793,0.336850506),
		vec3(0.023485932,0.49018203,0.335356658),
		vec3(0.023972563,0.49136356,0.333897676),
		vec3(0.023752527,0.492565791,0.332391228),
		vec3(0.023541133,0.493767535,0.330877961),
		vec3(0.024064843,0.494947395,0.329402888),
		vec3(0.023874302,0.496148099,0.327877135),
		vec3(0.023693179,0.4973483,0.32634462),
		vec3(0.024256537,0.49852644,0.324853675),
		vec3(0.024097876,0.499725568,0.32330881),
		vec3(0.023949407,0.500924176,0.321757249),
		vec3(0.024554979,0.502100549,0.32025069),
		vec3(0.024430577,0.503298051,0.318686941),
		vec3(0.024317138,0.504495016,0.317116576),
		vec3(0.024214911,0.50569144,0.315539624),
		vec3(0.024879698,0.506865404,0.314012337),
		vec3(0.02480365,0.508060679,0.312423452),
		vec3(0.024739576,0.509255397,0.310828079),
		vec3(0.024687724,0.510449552,0.309226254),
		vec3(0.024648337,0.511643138,0.307618013),
		vec3(0.02462166,0.512836152,0.306003394),
		vec3(0.024607936,0.514028587,0.304382439),
		vec3(0.024607407,0.515220439,0.30275519),
		vec3(0.024620311,0.516411703,0.301121693),
		vec3(0.025430344,0.517580022,0.299548786),
		vec3(0.025474016,0.518770047,0.297904143),
		vec3(0.025531852,0.519959469,0.296253407),
		vec3(0.025604088,0.521148283,0.294596635),
		vec3(0.024894659,0.522359022,0.292862225),
		vec3(0.02499313,0.523546652,0.291192319),
		vec3(0.025106673,0.524733661,0.28951655),
		vec3(0.025235513,0.525920043,0.287834984),
		vec3(0.025379875,0.527105795,0.286147691),
		vec3(0.025539979,0.528290911,0.284454743),
		vec3(0.025716046,0.529475387,0.282756217),
		vec3(0.025908292,0.530659219,0.281052193),
		vec3(0.026116931,0.531842404,0.279342754),
		vec3(0.025516046,0.533047872,0.27754491),
		vec3(0.025754689,0.534229792,0.275823595),
		vec3(0.026010334,0.53541105,0.274097131),
		vec3(0.026283184,0.536591645,0.272365617),
		vec3(0.025733668,0.537794676,0.270540763),
		vec3(0.026038044,0.538973973,0.268798115),
		vec3(0.026360197,0.540152594,0.267050734),
		vec3(0.025850174,0.541353764,0.265206244),
		vec3(0.026204922,0.542531064,0.263448376),
		vec3(0.026577992,0.543707678,0.261686137),
		vec3(0.026108901,0.54490695,0.259822963),
		vec3(0.026515573,0.546082222,0.258050976),
		vec3(0.026073369,0.547280223,0.256175459),
		vec3(0.026514269,0.548454139,0.254394266),
		vec3(0.026974316,0.549627352,0.252609418),
		vec3(0.026575225,0.550823402,0.250717112),
		vec3(0.027070395,0.55199524,0.24892398),
		vec3(0.026699527,0.553189985,0.247020724),
		vec3(0.027230366,0.554360437,0.245219983),
		vec3(0.026888197,0.555553863,0.243306422),
		vec3(0.026558752,0.556746643,0.241387184),
		vec3(0.027142187,0.557915015,0.23957565),
		vec3(0.026842079,0.55910646,0.237647174),
		vec3(0.027462381,0.560273418,0.235829985),
		vec3(0.027192001,0.561463517,0.233893077),
		vec3(0.026934796,0.562652956,0.231951448),
		vec3(0.027609293,0.563817798,0.230126689),
		vec3(0.027382323,0.565005876,0.22817796),
		vec3(0.027168746,0.566193287,0.226225191),
		vec3(0.027898217,0.567355993,0.224395144),
		vec3(0.027715299,0.568542032,0.222436797),
		vec3(0.027545949,0.569727397,0.220475188),
		vec3(0.027390215,0.570912086,0.218510594),
		vec3(0.027248137,0.572096099,0.216543302),
		vec3(0.028068035,0.573255236,0.214709163),
		vec3(0.027957117,0.574437859,0.212739279),
		vec3(0.027859961,0.5756198,0.210767666),
		vec3(0.02777659,0.576801059,0.208794669),
		vec3(0.02770702,0.577981633,0.206820645),
		vec3(0.027651267,0.579161521,0.204845969),
		vec3(0.028580285,0.580316346,0.203018249),
		vec3(0.028555966,0.581494832,0.201045509),
		vec3(0.028545482,0.582672632,0.19907337),
		vec3(0.028548825,0.583849743,0.197102277),
		vec3(0.028565986,0.585026166,0.195132695),
		vec3(0.028596949,0.586201899,0.193165105),
		vec3(0.028641696,0.587376944,0.191200012),
		vec3(0.028700201,0.588551299,0.189237942),
		vec3(0.028772437,0.589724966,0.187279441),
		vec3(0.028858369,0.590897943,0.185325081),
		vec3(0.028957961,0.592070232,0.183375455),
		vec3(0.029071169,0.593241833,0.18143118),
		vec3(0.029197947,0.594412746,0.179492901),
		vec3(0.029338246,0.595582973,0.177561288),
		vec3(0.028467805,0.59677727,0.175458158),
		vec3(0.028631158,0.597946151,0.173539467),
		vec3(0.028807855,0.599114348,0.171629575),
		vec3(0.028997829,0.600281863,0.169729263),
		vec3(0.029201008,0.601448698,0.167839341),
		vec3(0.02941732,0.602614852,0.165960649),
		vec3(0.029646687,0.60378033,0.164094058),
		vec3(0.028838261,0.604970052,0.162043002),
		vec3(0.02908969,0.606134204,0.160200566),
		vec3(0.029353924,0.607297684,0.158372998),
		vec3(0.029630873,0.608460496,0.156561298),
		vec3(0.029920442,0.609622641,0.154766498),
		vec3(0.029152932,0.610809151,0.152777704),
		vec3(0.029463679,0.611969995,0.151016965),
		vec3(0.029786757,0.613130181,0.149276386),
		vec3(0.030122062,0.614289712,0.147557132),
		vec3(0.02938494,0.615473702,0.145636142),
		vec3(0.029740637,0.616631956,0.143960058),
		vec3(0.030108247,0.617789568,0.142308949),
		vec3(0.030487659,0.61894654,0.140684099),
		vec3(0.029779391,0.620128062,0.138849768),
		vec3(0.030178361,0.621283788,0.13727821),
		vec3(0.030588802,0.622438888,0.135736906),
		vec3(0.029900235,0.623618605,0.133980261),
		vec3(0.030329592,0.624772487,0.132500396),
		vec3(0.030770081,0.625925758,0.131054971),
		vec3(0.030100324,0.627103712,0.129388392),
		vec3(0.03055908,0.628255797,0.128012899),
		vec3(0.031028627,0.629407288,0.126676143),
		vec3(0.030376786,0.630583528,0.125112481),
		vec3(0.030863949,0.631733868,0.123854295),
		vec3(0.030222397,0.632909001,0.122365266),
		vec3(0.030726753,0.634058217,0.121191377),
		vec3(0.031241334,0.635206874,0.120063295),
		vec3(0.030616247,0.636380389,0.11869872),
		vec3(0.03114738,0.637527966,0.117663186),
		vec3(0.03053165,0.638700445,0.116387265),
		vec3(0.031078919,0.639846975,0.115449431),
		vec3(0.031635855,0.640992987,0.114563649),
		vec3(0.031035183,0.64216397,0.113431889),
		vec3(0.031607628,0.64330899,0.112650573),
		vec3(0.031015409,0.644479025,0.111619372),
		vec3(0.031602954,0.645623095,0.110946273),
		vec3(0.031018834,0.646792224,0.110019345),
		vec3(0.031621071,0.647935386,0.1094574),
		vec3(0.031044687,0.649103657,0.108637522),
		vec3(0.031657052,0.650246572,0.108139762),
		vec3(0.031078364,0.651415454,0.107313457),
		vec3(0.031693676,0.652559174,0.106796724),
		vec3(0.032312181,0.65370329,0.106271344),
		vec3(0.031729478,0.654873407,0.105409465),
		vec3(0.032350963,0.656018326,0.104863999),
		vec3(0.031764471,0.657189267,0.103976142),
		vec3(0.031521425,0.658352324,0.103264533),
		vec3(0.031453897,0.659508143,0.102974324),
		vec3(0.032610589,0.660638609,0.103020466),
		vec3(0.032554806,0.661794982,0.102726636),
		vec3(0.032503636,0.662951631,0.102430237),
		vec3(0.032457114,0.664108553,0.102131243),
		vec3(0.032415275,0.66526575,0.101829633),
		vec3(0.032378156,0.666423221,0.101525382),
		vec3(0.032345792,0.667580965,0.101218466),
		vec3(0.032399034,0.668737551,0.100907302),
		vec3(0.032587525,0.669892112,0.100590901),
		vec3(0.032913416,0.671044625,0.100269178),
		vec3(0.03213479,0.672220621,0.09958752),
		vec3(0.032744844,0.673368872,0.099253112),
		vec3(0.032253341,0.674540483,0.098554118),
		vec3(0.033163358,0.67568426,0.098206412),
		vec3(0.032974803,0.676851276,0.097489284),
		vec3(0.032942454,0.678015913,0.09676134),
		vec3(0.033070249,0.679178119,0.096022297),
		vec3(0.033362115,0.680337844,0.095271868),
		vec3(0.032557293,0.681520536,0.09413327),
		vec3(0.033186838,0.68267514,0.093355954),
		vec3(0.032723251,0.68385258,0.092182066),
		vec3(0.033706199,0.685001867,0.091376196),
		vec3(0.033599669,0.686173863,0.090164788),
		vec3(0.033676596,0.687343054,0.088931232),
		vec3(0.033940957,0.688509394,0.087674702),
		vec3(0.033117851,0.689698201,0.085985078),
		vec3(0.033767105,0.690858677,0.084674299),
		vec3(0.033333227,0.69204148,0.082915193),
		vec3(0.033099154,0.693221199,0.08111497),
		vec3(0.033068957,0.694397785,0.079271415),
		vec3(0.033246706,0.695571194,0.077382104),
		vec3(0.033636471,0.696741379,0.075444388),
		vec3(0.034242326,0.697908294,0.07345535),
		vec3(0.033776127,0.699097048,0.070932339),
		vec3(0.03353124,0.700282381,0.068325778),
		vec3(0.033511853,0.701464248,0.065628598),
		vec3(0.033722153,0.702642603,0.062832684),
		vec3(0.034166333,0.703817401,0.059928648),
		vec3(0.034848588,0.704988599,0.056905533),
		vec3(0.034473043,0.706181096,0.053159739),
		vec3(0.034341675,0.707369828,0.049209831),
		vec3(0.034458802,0.708554752,0.045024438),
		vec3(0.034828747,0.709735821,0.040563383),
		vec3(0.034151663,0.710937774,0.035140825),
		vec3(0.041538366,0.711987209,0.033992954),
		vec3(0.050871522,0.712983468,0.03426688),
		vec3(0.059394008,0.713976071,0.034533156),
		vec3(0.066395785,0.714989707,0.03407019),
		vec3(0.073913424,0.715974883,0.034318931),
		vec3(0.081040424,0.716956303,0.034559622),
		vec3(0.087847668,0.717933935,0.03479213),
		vec3(0.093695262,0.718932408,0.034287908),
		vec3(0.100048501,0.719902351,0.034501822),
		vec3(0.106203357,0.72086841,0.034707153),
		vec3(0.112186492,0.721830553,0.034903769),
		vec3(0.118019615,0.722788751,0.035091537),
		vec3(0.123179955,0.723767547,0.034533174),
		vec3(0.128786418,0.724717744,0.034701031),
		vec3(0.134286517,0.725663906,0.034859643),
		vec3(0.139691323,0.726606002,0.035008879),
		vec3(0.145010354,0.727544005,0.035148605),
		vec3(0.150251847,0.728477885,0.035278691),
		vec3(0.155422984,0.729407615,0.035399005),
		vec3(0.160530064,0.730333167,0.035509414),
		vec3(0.165174519,0.73127891,0.034858558),
		vec3(0.170181886,0.732195998,0.03494697),
		vec3(0.175139324,0.733108825,0.035025089),
		vec3(0.180050822,0.734017366,0.035092784),
		vec3(0.184919963,0.734921593,0.035149925),
		vec3(0.189749971,0.735821482,0.035196383),
		vec3(0.19454376,0.736717007,0.035232027),
		vec3(0.199303969,0.737608142,0.03525673),
		vec3(0.204032999,0.738494862,0.035270363),
		vec3(0.208733036,0.739377144,0.035272798),
		vec3(0.213406077,0.740254964,0.035263907),
		vec3(0.218353386,0.741104216,0.036014396),
		vec3(0.222970761,0.741973072,0.035984236),
		vec3(0.227566481,0.742837395,0.035942366),
		vec3(0.23214195,0.743697164,0.03588866),
		vec3(0.23669846,0.744552354,0.035822994),
		vec3(0.24123721,0.745402944,0.035745242),
		vec3(0.245759306,0.746248912,0.035655279),
		vec3(0.250521296,0.747066408,0.036336485),
		vec3(0.255007773,0.747903108,0.036223471),
		vec3(0.25948065,0.748735123,0.036097873),
		vec3(0.26394074,0.749562433,0.035959569),
		vec3(0.268388804,0.750385017,0.035808438),
		vec3(0.27305598,0.751179232,0.036436921),
		vec3(0.277477584,0.75199235,0.036261493),
		vec3(0.281889289,0.752800684,0.036072874),
		vec3(0.286508847,0.753580725,0.036669057),
		vec3(0.29089835,0.754379482,0.036455406),
		vec3(0.295279684,0.7551734,0.036228203),
		vec3(0.299858411,0.755939114,0.036790966),
		vec3(0.304221029,0.756723349,0.036538008),
		vec3(0.308576892,0.757502693,0.036271144),
		vec3(0.3131204,0.758253934,0.036799381),
		vec3(0.317460423,0.759023497,0.03650605),
		vec3(0.321794855,0.759788118,0.036198466),
		vec3(0.326307817,0.760524749,0.036691091),
		vec3(0.330628796,0.761279495,0.036356341),
		vec3(0.335122536,0.762006331,0.03682532),
		vec3(0.339431479,0.762751143,0.036462942),
		vec3(0.343907649,0.763468132,0.036907801),
		vec3(0.348205812,0.764202953,0.03651734),
		vec3(0.352665887,0.764910044,0.036937613),
		vec3(0.356954384,0.765634819,0.03651862),
		vec3(0.361399681,0.766331964,0.036913844),
		vec3(0.365836676,0.767024148,0.037297396),
		vec3(0.370111201,0.767733792,0.036835598),
		vec3(0.3745352,0.768415963,0.037193417),
		vec3(0.378802384,0.769115437,0.036701991),
		vec3(0.383214385,0.76978755,0.037033631),
		vec3(0.387619504,0.770454653,0.037353031),
		vec3(0.391875863,0.771138821,0.036817178),
		vec3(0.396270341,0.771795809,0.03710974),
		vec3(0.400658636,0.77244776,0.037389732),
		vec3(0.405040972,0.773094668,0.037657042),
		vec3(0.4092845,0.773758309,0.037061018),
		vec3(0.413657724,0.77439503,0.037300634),
		vec3(0.418025555,0.775026685,0.037527249),
		vec3(0.422388177,0.775653265,0.037740754),
		vec3(0.426621128,0.776296231,0.037082934),
		vec3(0.430975872,0.776912563,0.03726792),
		vec3(0.435325866,0.777523801,0.037439488),
		vec3(0.439671263,0.77812994,0.037597535),
		vec3(0.444012203,0.778730973,0.037741961),
		vec3(0.448348822,0.779326897,0.037872664),
		vec3(0.452681249,0.779917705,0.037989545),
		vec3(0.45689842,0.78052425,0.037221008),
		vec3(0.461224628,0.781104721,0.037307995),
		vec3(0.465546962,0.781680062,0.037380872),
		vec3(0.469865529,0.782250269,0.037439543),
		vec3(0.474180429,0.782815337,0.037483913),
		vec3(0.478491756,0.783375263,0.037513891),
		vec3(0.482799601,0.783930043,0.037529383),
		vec3(0.48710405,0.784479675,0.037530298),
		vec3(0.491405183,0.785024155,0.037516547),
		vec3(0.495703079,0.785563481,0.03748804),
		vec3(0.499997809,0.786097649,0.03744469),
		vec3(0.504382163,0.786606893,0.038279135),
		vec3(0.508669226,0.787130848,0.038207739),
		vec3(0.512953343,0.787649642,0.038121238),
		vec3(0.517234571,0.788163271,0.038019549),
		vec3(0.521512967,0.788671734,0.037902589),
		vec3(0.525788584,0.78917503,0.037770279),
		vec3(0.530061472,0.789673157,0.037622537),
		vec3(0.534413976,0.790147138,0.038365643),
		vec3(0.538680131,0.790635045,0.038188668),
		vec3(0.542943708,0.791117782,0.037996024),
		vec3(0.547204746,0.791595348,0.037787637),
		vec3(0.551540006,0.792049251,0.038477658),
		vec3(0.555794729,0.792516601,0.038239404),
		vec3(0.560047035,0.792978782,0.037985183),
		vec3(0.564369652,0.79341768,0.038635112),
		vec3(0.56861591,0.793869652,0.038350572),
		vec3(0.572859854,0.794316457,0.038049853),
		vec3(0.577170311,0.794740377,0.038658988),
		vec3(0.581408436,0.795176984,0.038327519),
		vec3(0.585644333,0.795608427,0.037979669),
		vec3(0.589943047,0.796017398,0.038547339),
		vec3(0.594173321,0.796438657,0.03816833),
		vec3(0.598464001,0.796837728,0.038708751),
		vec3(0.602688773,0.797248814,0.038298317),
		vec3(0.606971582,0.797638004,0.038811208),
		vec3(0.611190962,0.798038928,0.038369095),
		vec3(0.615466048,0.798418257,0.038854184),
		vec3(0.619680134,0.798809034,0.038380147),
		vec3(0.623947633,0.799178522,0.038837172),
		vec3(0.628156512,0.799559165,0.038330975),
		vec3(0.632416548,0.799918834,0.038759684),
		vec3(0.636620298,0.800289359,0.038221101),
		vec3(0.640872983,0.800639231,0.038621251),
		vec3(0.645121475,0.800984295,0.039008131),
		vec3(0.649317113,0.801339752,0.038421423),
		vec3(0.653558414,0.801675057,0.038779393),
		vec3(0.65779561,0.802005573,0.039123915),
		vec3(0.661983292,0.802346007,0.03848861),
		vec3(0.666213438,0.802666803,0.03880389),
		vec3(0.670439556,0.802982834,0.039105555),
		vec3(0.674619415,0.803308291,0.038421215),
		vec3(0.678838605,0.803614642,0.038693329),
		vec3(0.683053836,0.803916251,0.03895167),
		vec3(0.687265133,0.804213127,0.039196189),
		vec3(0.691434393,0.804518749,0.03844639),
		vec3(0.695638905,0.804806002,0.038660973),
		vec3(0.69983954,0.805088547,0.038861589),
		vec3(0.70403632,0.805366391,0.039048191),
		vec3(0.708229262,0.805639544,0.039220733),
		vec3(0.712385271,0.805920553,0.038388593),
		vec3(0.71657158,0.806184158,0.03853077),
		vec3(0.720754099,0.806443098,0.038658761),
		vec3(0.724932846,0.80669738,0.038772523),
		vec3(0.729107837,0.806947015,0.038872018),
		vec3(0.733279087,0.807192011,0.038957206),
		vec3(0.737446612,0.807432378,0.039028048),
		vec3(0.741610426,0.807668124,0.039084508),
		vec3(0.745770542,0.80789926,0.039126549),
		vec3(0.749926976,0.808125795,0.039154137),
		vec3(0.754079738,0.808347738,0.039167238),
		vec3(0.758228843,0.808565098,0.03916582),
		vec3(0.762374302,0.808777885,0.039149851),
		vec3(0.766516126,0.808986108,0.039119301),
		vec3(0.770649608,0.809193079,0.038567415),
		vec3(0.774827155,0.809377405,0.039090444),
		vec3(0.779012638,0.809557143,0.038672783),
		vec3(0.783242749,0.809713621,0.039343365),
		vec3(0.787482647,0.809864682,0.039076722),
		vec3(0.791750152,0.810001033,0.03888658),
		vec3(0.796045207,0.81012251,0.038772946),
		vec3(0.800367749,0.810228949,0.038735823),
		vec3(0.804717718,0.810320181,0.038775211),
		vec3(0.809095052,0.810396037,0.038891105),
		vec3(0.813499688,0.810456347,0.039083497),
		vec3(0.817931562,0.810500937,0.039352375),
		vec3(0.822390607,0.81052963,0.039697721),
		vec3(0.826876758,0.810542251,0.040119513),
		vec3(0.83138359,0.810544426,0.039625739),
		vec3(0.835924692,0.810524064,0.040202011),
		vec3(0.84049269,0.810487083,0.040846632),
		vec3(0.845083974,0.810438201,0.040594312),
		vec3(0.849706483,0.810367114,0.041381277),
		vec3(0.854353993,0.81028313,0.041284263),
		vec3(0.859029957,0.810181141,0.041264615),
		vec3(0.86373429,0.810060944,0.041322269),
		vec3(0.868466905,0.80992233,0.041456898),
		vec3(0.873227712,0.809765092,0.041667909),
		vec3(0.87801662,0.809589018,0.041954456),
		vec3(0.882833537,0.809393894,0.04231545),
		vec3(0.887678365,0.809179505,0.042749574),
		vec3(0.892551009,0.808945631,0.043255301),
		vec3(0.897457941,0.808693387,0.042921795),
		vec3(0.902386818,0.808419534,0.043575482),
		vec3(0.907351577,0.808126157,0.043396638),
		vec3(0.91233626,0.807811406,0.044192996),
		vec3(0.917358397,0.807475953,0.044166227),
		vec3(0.922409495,0.807118917,0.044215282),
		vec3(0.92748943,0.806740051,0.044339717),
		vec3(0.932598079,0.806339104,0.04453884),
		vec3(0.937735311,0.805915823,0.044811722),
		vec3(0.942900997,0.805469951,0.045157203),
		vec3(0.948095,0.805001229,0.045573911),
		vec3(0.953317184,0.804509396,0.046060278),
		vec3(0.95708171,0.804262657,0.099437203),
		vec3(0.959699583,0.804249384,0.154035713),
		vec3(0.96180453,0.804368996,0.198138701),
		vec3(0.963576172,0.804589866,0.23513469),
		vec3(0.965091471,0.804896772,0.267242914),
		vec3(0.966422405,0.805274151,0.295562739),
		vec3(0.967626864,0.805708497,0.320799561),
		vec3(0.968709388,0.806197277,0.343712423),
		vec3(0.969731005,0.80672581,0.364473251),
		vec3(0.970625255,0.807307239,0.383871485),
		vec3(0.971481151,0.807920707,0.401710854),
		vec3(0.972290375,0.808566705,0.418293756),
		vec3(0.973037785,0.809247564,0.433879738),
		vec3(0.973701588,0.809967451,0.448698723),
		vec3(0.974378467,0.810702983,0.462472545),
		vec3(0.975004751,0.811468059,0.4755715),
		vec3(0.975593634,0.812258831,0.488026277),
		vec3(0.976158242,0.813071427,0.49986281),
		vec3(0.976711632,0.813901959,0.511103222),
		vec3(0.977217401,0.81475863,0.521921349),
		vec3(0.977683924,0.815638904,0.532330373),
		vec3(0.978171946,0.816527203,0.542189305),
		vec3(0.978640388,0.817433074,0.551663041),
		vec3(0.97904219,0.818367884,0.560911416),
		vec3(0.979494826,0.819301631,0.569640164),
		vec3(0.979894382,0.820260058,0.578157484),
		vec3(0.980244701,0.821241931,0.586467834),
		vec3(0.98067196,0.822214506,0.594279919),
		vec3(0.981000856,0.823222427,0.60204269),
		vec3(0.981358981,0.824232492,0.609464784),
		vec3(0.981689018,0.825259188,0.616697035),
		vec3(0.982061667,0.826283708,0.623597176),
		vec3(0.982348483,0.827339415,0.63045891),
		vec3(0.982688416,0.828389512,0.636994955),
		vec3(0.982947391,0.829469131,0.643496448),
		vec3(0.98326997,0.830539698,0.649678016),
		vec3(0.983590321,0.831618359,0.655685883),
		vec3(0.983837066,0.832724021,0.661664165),
		vec3(0.984086494,0.833836088,0.667471792),
		vec3(0.984420408,0.834932218,0.672969488),
		vec3(0.984608762,0.836074295,0.67858256),
		vec3(0.984889272,0.837197866,0.683889241),
		vec3(0.985187799,0.838322706,0.689032358),
		vec3(0.985424771,0.839470314,0.694152981),
		vec3(0.985599951,0.840640691,0.699251449),
		vec3(0.985885322,0.841786573,0.704050738),
		vec3(0.98611386,0.842953517,0.708830073),
		vec3(0.986285361,0.844141517,0.713589736),
		vec3(0.98648975,0.845325663,0.718192453),
		vec3(0.986730851,0.846504683,0.722639585),
		vec3(0.986919702,0.847703038,0.72706929),
		vec3(0.987150237,0.848894566,0.731345311),
		vec3(0.987330846,0.85010456,0.735605058),
		vec3(0.987558115,0.851306029,0.739712932),
		vec3(0.987737801,0.852525094,0.743805623),
		vec3(0.987969124,0.853733945,0.747748171),
		vec3(0.988155223,0.854959521,0.751676571),
		vec3(0.988295978,0.856201792,0.755591008),
		vec3(0.988494537,0.85743173,0.759357447),
		vec3(0.988650137,0.85867749,0.763110898),
		vec3(0.988868524,0.859909247,0.766717916),
		vec3(0.989046345,0.861155957,0.770312876),
		vec3(0.989183515,0.862417579,0.773895936),
		vec3(0.989389648,0.86366311,0.777334507),
		vec3(0.989557543,0.864922686,0.780762058),
		vec3(0.989687136,0.866196264,0.784178735),
		vec3(0.989778365,0.867483793,0.787584687),
		vec3(0.989945959,0.86875273,0.790848412),
		vec3(0.990077629,0.870034756,0.794102238),
		vec3(0.990290623,0.871296578,0.797215175),
		vec3(0.990470125,0.872570636,0.800319001),
		vec3(0.990616109,0.87385688,0.803413845),
		vec3(0.99072855,0.875155252,0.806499837),
		vec3(0.990807433,0.876465695,0.809577109),
		vec3(0.990976245,0.877753078,0.812515896),
		vec3(0.991113955,0.87905169,0.815446696),
		vec3(0.991220562,0.880361469,0.818369632),
		vec3(0.991423231,0.881646221,0.821155626),
		vec3(0.991597244,0.882941315,0.82393445),
		vec3(0.991742618,0.88424669,0.826706216),
		vec3(0.991859372,0.885562283,0.829471041),
		vec3(0.991947535,0.886888028,0.83222904),
		vec3(0.992007138,0.888223854,0.834980329),
		vec3(0.992172567,0.889531515,0.837597107),
		vec3(0.992311892,0.890848452,0.840207812),
		vec3(0.992425158,0.892174596,0.842812552),
		vec3(0.992512418,0.893509878,0.845411436),
		vec3(0.992712739,0.894814751,0.847877435),
		vec3(0.992749332,0.896167769,0.85046512),
		vec3(0.992901422,0.897489598,0.852920507),
		vec3(0.993030069,0.898819641,0.855370832),
		vec3(0.993135346,0.900157824,0.857816197),
		vec3(0.993217334,0.901504072,0.860256703),
		vec3(0.993421933,0.902816994,0.862566376),
		vec3(0.993458729,0.904178839,0.864997636),
		vec3(0.993620538,0.905506616,0.867298591),
		vec3(0.993761639,0.906841561,0.869595409),
		vec3(0.993882131,0.908183598,0.871888183),
		vec3(0.993982117,0.909532651,0.874177008),
		vec3(0.994061708,0.910888637,0.876461976),
		vec3(0.99412102,0.912251476,0.878743182),
		vec3(0.994314639,0.913577527,0.880895859),
		vec3(0.994334823,0.91495355,0.88316996),
		vec3(0.994491659,0.916292096,0.885315986),
		vec3(0.994630802,0.917636638,0.887458883),
		vec3(0.994593795,0.919031676,0.889723073),
		vec3(0.994696939,0.920388217,0.891859842),
		vec3(0.994943397,0.921705441,0.893869641),
		vec3(0.995013114,0.923073156,0.896000863),
		vec3(0.995065837,0.924446451,0.898129378),
		vec3(0.995101719,0.925825237,0.900255269),
		vec3(0.995285437,0.927163437,0.902254965),
		vec3(0.995289098,0.928552715,0.904375961),
		vec3(0.995442824,0.929900791,0.906371128),
		vec3(0.995582257,0.931253572,0.908364192),
		vec3(0.995707554,0.932610975,0.910355228),
		vec3(0.995818881,0.933972916,0.912344306),
		vec3(0.995916407,0.935339311,0.9143315),
		vec3(0.996000303,0.936710074,0.91631688),
		vec3(0.996070747,0.938085116,0.918300518),
		vec3(0.996127921,0.939464351,0.920282485),
		vec3(0.996172011,0.940847687,0.92226285),
		vec3(0.996377595,0.942186874,0.924118983),
		vec3(0.99639694,0.943577974,0.926096422),
		vec3(0.996403773,0.944972905,0.928072463),
		vec3(0.996575167,0.946322921,0.929924668),
		vec3(0.996736063,0.947676269,0.93177573),
		vec3(0.996708214,0.949081838,0.933748093),
		vec3(0.996847896,0.950441761,0.935596983),
		vec3(0.996977642,0.95180477,0.937444903),
		vec3(0.997097643,0.953170782,0.939291907),
		vec3(0.997026623,0.954589245,0.941260238),
		vec3(0.997126989,0.955961149,0.943105531),
		vec3(0.997218204,0.957335804,0.944950073),
		vec3(0.997300471,0.958713127,0.946793916),
		vec3(0.99737399,0.960093036,0.948637111),
		vec3(0.997623961,0.961425318,0.950357713),
		vec3(0.997681275,0.96281004,0.952199796),
		vec3(0.997730449,0.9641971,0.954041377),
		vec3(0.997771692,0.965586415,0.955882507),
		vec3(0.997805214,0.966977901,0.957723232),
		vec3(0.998019452,0.968320863,0.959441732),
		vec3(0.998038789,0.969716361,0.961281804),
		vec3(0.998051031,0.971113786,0.963121606),
		vec3(0.998246412,0.972462205,0.964839365),
		vec3(0.998245694,0.97386317,0.966678767),
		vec3(0.998429661,0.975214831,0.968396234),
		vec3(0.998416794,0.976619029,0.970235397),
		vec3(0.998590116,0.977973646,0.971952718),
		vec3(0.998565908,0.979380775,0.973791794),
		vec3(0.998729349,0.980738066,0.975509111),
		vec3(0.998888376,0.982096565,0.977226477),
		vec3(0.998848919,0.98350752,0.979065692),
		vec3(0.998999186,0.984868287,0.980783251),
		vec3(0.999145577,0.986230069,0.982500951),
		vec3(0.999092609,0.987644221,0.984340605),
		vec3(0.999231319,0.989007887,0.986058678),
		vec3(0.999366908,0.990372308,0.987777012),
		vec3(0.999499592,0.991737412,0.989495639),
		vec3(0.999431931,0.993154719,0.991336379),
		vec3(0.999558343,0.994521216,0.993055602),
		vec3(0.999681819,0.995888396,0.994775118),
		vec3(0.999802351,0.99725626,0.996494928),
		vec3(0.999720702,0.998676434,0.998336888),
		vec3(1,1,1)
	);

	out vec4 fragColor;
	void main(void) {
		vec2 centeredCoords = gl_FragCoord.xy - vec2(float(CANVAS_WIDTH) / 2.0, float(CANVAS_HEIGHT) / 2.0);


		vec2 hexCoord = mod(vec2(UNIVERSE_WIDTH, UNIVERSE_HEIGHT) + mat2(
			2.0/3.0, -1.0/3.0,
			0, sqrt(3.0)/3.0
		) * centeredCoords, vec2(UNIVERSE_WIDTH, UNIVERSE_HEIGHT));

		uint v = universe[0].cells[uint(hexCoord.x)][uint(hexCoord.y)].x;

		float col = float(v) / float(colorMax);
		
		fragColor = vec4(gradient[uint(col * float(1024))], 1.0);
	}`


const transitionFunc = direction => {
	return `
		#undef PREV
		#undef NEXT
		#undef VAL
		#define PREV universe[${direction ^ 0}].cells
		#define NEXT universe[${direction ^ 1}].cells
		#define VAL val${direction}

		// uint VAL = 
		// 	C(PREV).x - (C(PREV).x >= uint(7) ? (uint(6) * (C(PREV).x / uint(7))) : uint(0)) +
		// 	(N(PREV).x >= uint(7) ? N(PREV).x / uint(7) : uint(0)) +
		// 	(NE(PREV).x >= uint(7) ? NE(PREV).x / uint(7) : uint(0)) +
		// 	(SE(PREV).x >= uint(7) ? SE(PREV).x / uint(7) : uint(0)) +
		// 	(S(PREV).x >= uint(7) ? S(PREV).x / uint(7) : uint(0)) +
		// 	(SW(PREV).x >= uint(7) ? SW(PREV).x / uint(7) : uint(0)) +
		// 	(NW(PREV).x >= uint(7) ? NW(PREV).x / uint(7) : uint(0));


		uint VAL = 
			C(PREV).x - (uint(6) * (C(PREV).x / uint(7))) +
			N(PREV).x / uint(7)  +
			NE(PREV).x / uint(7) +
			SE(PREV).x / uint(7) +
			S(PREV).x / uint(7)  +
			SW(PREV).x / uint(7) +
			NW(PREV).x / uint(7);
			
		#if ${direction} == 1
			atomicMax(colorMax, VAL);
		#endif

		C(NEXT).x = VAL;
		
		

	`
}

const computeShaderSource = `#version 310 es

	layout( local_size_x = 1 ) in;

	${HEADER_INCLUDE("COMPUTE")}

	#define C(u) u[x][y]
	#define N(u) u[x][ym1]
	#define NE(u) u[xp1][ym1]
	#define SE(u) u[xp1][y]
	#define S(u) u[x][yp1]
	#define SW(u) u[xm1][yp1]
	#define NW(u) u[xm1][y]

	void main(void){
		uint x = gl_GlobalInvocationID.x;
		uint y = gl_GlobalInvocationID.y;
		if (x == uint(0) && y == uint(0)){
			colorMax = uint(1);
		}
		barrier();

		uint xm1 = x == uint(0) ? uint(UNIVERSE_WIDTH - 1) : x - uint(1);
		uint xp1 = x == uint(UNIVERSE_WIDTH - 1) ? uint(0) : x + uint(1);
		uint ym1 = y == uint(0) ? uint(UNIVERSE_HEIGHT - 1) : y - uint(1);
		uint yp1 = y == uint(UNIVERSE_HEIGHT - 1) ? uint(0) : y + uint(1);
		${transitionFunc(0)}
		barrier();
		memoryBarrierBuffer();
		${transitionFunc(1)}
	}`

const lined = (s) => s.split(/[\r\n]+/).map((x, i) => `${i}. ${x}`).join("\n")

console.log(
	lined(fragmentShaderSource) + "\n=====================================\n" + lined(computeShaderSource)
)
export default gl => {

	const createShader = (program, sourceCode, type) => {
		// Compiles either a shader of type gl.VERTEX_SHADER or gl.FRAGMENT_SHADER
		const shader = gl.createShader(gl[type])
		gl.shaderSource(shader, sourceCode)
		gl.compileShader(shader)

		if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS))
			throw `Could not compile WebGL ${type} shader. ${gl.getShaderInfoLog(shader)}`

		gl.attachShader(program, shader)

		return shader
	}

	const createProgram = shaders => {
		const program = gl.createProgram()

		for (const [source, type] of shaders)
			createShader(program, source, type)

		gl.linkProgram(program)

		if (!gl.getProgramParameter(program, gl.LINK_STATUS))
			throw `Could not compile WebGL program. ${gl.getProgramInfoLog(program)}`

		return program
	}

	return {
		renderProgram: createProgram([
			[vertexShaderSource, "VERTEX_SHADER"],
			[fragmentShaderSource, "FRAGMENT_SHADER"]
		]),
		computeProgram: createProgram([
			[computeShaderSource, "COMPUTE_SHADER"]
		])
	}
}

